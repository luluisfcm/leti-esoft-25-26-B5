# US10 - As Administrator, I want to specify a new vaccine type.



## 1. Requirements Engineering


### 1.1. User Story Description

As Receptionist, I want to register an SNS user.

### 1.2. Customer Specifications and Clarifications

**From the specifications document:**

> SNS users must be registered in the system with the following data: name, date of birth, sex, postal address, phone number, email, citizen card number, and SNS user number.

**From the client clarifications:**

> **Question:** Nesta US é referido como um dos AC que o Nº telemóvel e Nº CC registado devem ser no formato Português.
No caso do Nº CC o utilizador deve introduzir o formato CC simples de 8 dígitos apenas "xxxxxxxx" ou o formato completo composto pelos 8 dígitos mais os 4 caracteres seguintes " n xyz"? E a sua verificação quanto ao ser um input legitimamente português deve ser feito apenas tendo em conta o nº de dígitos introduzidos?
Por outro lado sobre o Nº telemóvel, a sua verificação do formato português como deve ser realizada? O sistema deve introduzir automaticamente o código "+351" e apenas verificar se o valor introduzido tem 9 dígitos válidos?
>
> **Answer:** No caso do número do Cartão de Cidadão, deve ser introduzido apenas o formato simples de 8 dígitos.
Quanto ao número de telemóvel, pretende-se um número com 9 dígitos.

> **Question:** Nesta US um dos AC é referente à introdução do atributo "Sex", podemos considerar este atributo como um selected data? Onde são dadas ao utilizador uma lista pré-definida de opções da qual deve selecionar uma?
Para além disso, e caso possamos considerar tal situação, sendo que este atributo é opcional esta decisão pode estar incluída no leque de opções dadas ao utilizador? Por exemplo " 1 -  Male ; 2 -  Female ; 3 - Prefer not to say", onde a opção "Prefer not to say"  representaria a decisão de não introdução do atributo "Sex" por parte do utilizador.
Ou é necessário fazer primeiro a verificação se o utilizador pretende introduzir tal atributo e só depois dar as respetivas opções disponíveis?>
> 
> **Answer:** Ambas as alternativas podem ser consideradas válidas, sendo que a opção male / female / prefer not to say, se adequa particularmente bem.

> **Question:** For the user identification code within the system, do we consider the SNS user number as the unique identifier?
> 
> **Answer:** AC20-3 establishes that Phone Number, E-mail Address, Citizen Card Number and SNS User Number must be unique across all registered SNS users. Therefore, any of these can serve as a unique identifier for the SNS user.

> **Question:** Does each SNS user have an associated health history in the system? If so, which specific health-related data should be stored (e.g., allergies, chronic conditions, contraindications, past vaccinations, adverse reactions)?
> 
> **Answer:** No. The system does not store health history when an SNS user is registered.

### 1.3. Acceptance Criteria

- AC20-1: The Phone Number and Citizen Card Number must comply with the Portuguese format.
- AC20-2: The attribute Sex is optional. All other fields are required.
- AC20-3: The Phone Number, E-mail Address, Citizen Card Number and SNS User Number must be
unique across all registered SNS users

### 1.4. Found out Dependencies

**Authentication:** The Receptionist must be registered and authenticated in the system to access this functionality.

### 1.5 Input and Output Data

**Input Data:**

* **Typed data:**
    * Name
    * Date of Birth
    * Postal Address
    * Phone Number
    * E-mail Address
    * Citizen Card Number
    * SNS User Number

* **Selected data:**
    * Sex

**Output Data:**
* List of gathered data (for confirmation)
* (In)success of the operation
* Error messages (in case of invalid formats, missing mandatory fields, or duplicate unique values)

### 1.6. System Sequence Diagram (SSD)

![USXX-SSD](svg/US20-SSD.svg)

### 1.7 Other Relevant Remarks

The registered SNS User is now available in the system to schedule vaccination appointments and request the issuance of vaccination certificates.
## 2. Analysis

### 2.1. Relevant Domain Model Excerpt


![USXX-DM](svg/US20-DM.svg)

### 2.2. Other Remarks

- The Receptionist interacts with the system to register the user.

- Data uniqueness must be enforced globally across the system persistence mechanism.
## 3. Design - User Story Realization

### 3.1. Rationale

**The rationale grounds on the SSD interactions and the identified input/output data.**

The rationale grounds on the SSD interactions and the identified input/output data.

| Interaction ID | Question: Which class is responsible for... | Answer | Justification (with patterns)                                                                                                          |
|:---|:---|:---|:---------------------------------------------------------------------------------------------------------------------------------------|
| **Step 1** | ... interacting with the actor? | `RegisterSNSUserView` | **Pure Fabrication:** Created solely to handle the user interface.                                                                     |
| | ... coordinating the US? | `RegisterSNSUserController` | **Controller:** Manages the flow by delegating work to the Service.                                                                    |
| **Step 2** | ... requesting data? | `RegisterSNSUserView` | **Information Expert:** Responsible for actor interaction and data input.                                                              |
| **Step 3** | ... instantiating the new SNS User? | `SNSUserService` | **Creator:** Orchestrates the transaction and creates the `SNSUser` object.                                                            |
| | ... validating formats (AC20-1)? | `SNSUser` | **Information Expert:** Validates its own constraints within the constructor.                                                          |
| **Step 4** | ... showing data for confirmation? | `RegisterSNSUserView` | **Information Expert:** Presents the gathered data for visual validation.                                                              |
| **Step 5** | ... validating uniqueness (AC20-3)? | `SNSUserService` | **Information Expert:** Uses the repository to check for existing duplicates.                                                          |
| | ... saving the SNS User? | `SNSUserRepository` | **Repository / Information Expert:** This class is responsible for communicating with the persistence mechanism and saving the object. |
| **Step 6** | ... informing operation success? | `RegisterSNSUserView` | **Information Expert:** Provides final feedback to the Receptionist.                                                                   |

### Systematization ##

According to the taken rationale, the conceptual classes promoted to software classes are:

- SNSUser
- Receptionist (Representing the actor/entity that initiates the process)

Other software classes (i.e. Pure Fabrication) identified:

- RegisterSNSUserView (View - matching your SSD/SD name)
- RegisterSNSUserController (Controller)
- SNSUserService (Service)
- SNSUserRepository (Repository Interface)
- RepositoryFactory (Abstract Factory Interface)


### 3.2. Sequence Diagram (SD)


![USXX-SD](svg/US20-SD.svg)

### 3.3. Class Diagram (CD)


![USXX-CD](svg/US20-CD.svg)


## 4. Tests
n/a

## 5. Construction (Implementation)

n/a

## 6. Integration and Demo

n/a

## 7. Observations
n/a